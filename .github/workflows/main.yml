name: BugKiller CI

# 1. Trigger: When code is pushed to the 'main' or 'master' branch
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  test:
    # 2. Environment: Use the latest Ubuntu image
    runs-on: ubuntu-latest

    steps:
    # 3. Checkout: Download the code to the runner
    - uses: actions/checkout@v4

    # 4. Run Everything using Docker Compose (V2 syntax)
    - name: Build and Run with Docker Compose
      run: |
        docker compose up -d --build
        
    # 5. Run API Tests inside the container
    - name: Run API Tests in Docker
      run: |
        docker compose exec -T web pytest tests/test_api.py
